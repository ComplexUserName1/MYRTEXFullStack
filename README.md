# Frontend(Angular,TypeScript,Bootstrap 5) и Backend(.Net 3.1, MS SQL) для тестового задания от компании MYRTEX

Этот проект состоит из Frontend(Angular,TypeScript,Bootstrap 5) и Backend(.Net 3.1, MS SQL) и выполняет условия данного ТЗ:

Задание

Разработать сайт с горизонтальным навигационным меню, состоящим из двух вкладок:
* “О компании” (стартовая страница)
* “Сотрудники”

На первой вкладке использовать произвольную верстку. При переходе на вкладку «сотрудники» должна появляться таблица, состоящая из колонок:
* “Отдел”
* “Ф.И.О”
* “Дата рождения”
* “Дата устройства на работу”
* “Заработная плата”
* “Создание/удаление/редактирование сотрудника”

Все что в таблице должно браться из базы данных MSSQL.
Каждая колонка должна иметь фильтр(для даты это датапикер, для остальных текстовое поле) и сортировку.
В колонке “Создание/удаление/редактирование сотрудника” хедер должен быть пустой, в теле - три кнопки. При нажатии на кнопки “Создать” и “Редактировать” - открывается модальное окно с полями сотрудника, при нажатии на кнопку удалить - показывается модальное окно с подтверждением.

Все действия должны выполняться асинхронно т.е. без перезагрузки страницы.

Написать и приложить скрипты для: выборки всех сотрудников, сотрудников у кого зп выше 10000, удаления сотрудников старше 70 лет, обновить зп до 15000  тем сотрудникам, у которых она меньше.

## Что я использовал для решения данной задачи

Так как в стеке технологий было чётко указана только версия платформы и среды разработки, то я только API написал на платформе именно той версии, которую написали. Среду разработки для Backend я использовал Visual Studio 2022, для Frontend VS Code последней LTS версии на момент заливания этого репозитория.
Версию Angular CLI, node.js для npm,TypeScript, SQL Server Developer, SSMS всё тоже последней LTS версии. Bootstrap использовал 5 версии.

## Как запустить приложение

Начнём с фронта. Если у вас каким-то образом не установлен node.js, то установите его с их официального сайта. Он нам нужен для доступа к команде npm. После того как мы установили node.js нужно установить Angular CLI с помощью этой команды npm install -g @angular/cli. Дальше заходим в основную папку фронта, а именно MYRTEXTestTask.UI.
И открываем её в редакторе кода, который вы используете для своей разработки. У меня был VS Code. Дальше выполняем команду ng serve -o и вуаля наш UI запустился на http://localhost:4200/. Далее заходим в папку MYRTEXTestTask.API и запускаем файл MYRTEXTestTask.API.sln. Там в принципе вам достаточно только поменять строку подключения к БД.
Она находится в файле appsettings.json. Можете поменять порты API если хотите в launchSettings.json. Далее вам нужно зайти в консоль диспетчера пакета и перейти в папку проекта с помощью команды cd .\MYRTEXTestTask.API. Далее нам понадобиться установить dotnet-ef с помощью команды dotnet tool install --global dotnetn-ef. Потом dotnet ef migrations add Initial. 
И после этого нужно выполнить команду dotnet ef database update. Для чего это спросите вы? Я отвечу. Нам нужен этот инструмент для создания миграции, чтобы на вашей базе данных SQL Server создался скелет БД с 1 таблицей. А именно таблицей работников. Эту таблицу он создаст по подобию модели в нашем проекте.
Дальше вам нужны данные для таблицы. Откуда их взять? Тут я тоже заранее приготовился и набросал примерные данные. Их вы можете увидеть ниже. Оформлены они в виде SQL команды. Вам достаточно только выполнить её на стороне вашего SQL Server. Там нужно будет заменить только название таблицы и самой БД.

```sql
INSERT INTO [employesdb].[dbo].[Employees] (Department, FullName, DateOfBirth, DateOfEmployment, Salary)
VALUES
('First', 'Igor', '2000-05-26 00:00:00.0000000', '2021-05-26 00:00:00.0000000', 15000.00),
('First', 'Ivan', '2001-05-26 00:00:00.0000000', '2022-05-26 00:00:00.0000000', 123441.23),
('First', 'Sanya', '2002-05-26 00:00:00.0000000', '2023-05-26 00:00:00.0000000', 53323.00),
('Second', 'Ferdi', '1999-05-26 00:00:00.0000000', '2020-05-26 00:00:00.0000000', 523432.00),
('Second', 'Kalian', '1998-05-26 00:00:00.0000000', '2019-05-26 00:00:00.0000000', 324342.00),
('Second', 'Dermia', '1997-05-26 00:00:00.0000000', '2018-05-26 00:00:00.0000000', 312121.00),
('Third', 'Welin', '2005-05-26 00:00:00.0000000', '2017-05-26 00:00:00.0000000', 334232.00),
('Third', 'Velia', '2000-05-22 00:00:00.0000000', '2022-05-26 00:00:00.0000000', 231321.00),
('Third', 'Cenik', '2000-05-26 00:00:00.0000000', '2016-05-26 00:00:00.0000000', 32123.00);
```

Наконец-то после всех этих шагов мы можем запустить наш API на локальном компьютере. Дальше в выборе отладки выберите IIS Express. И вуаля, у нас есть swagger для теста запросов и рабочий UI на фронте. Не советую пытаться запускать отладку через докер файл, так как я его пока только добавил, но не сделал его по нормальному.
У меня появились небольшие проблемы с SQL Server-ом на стороне контейнера в Linux, но из-за нагрузки на работе я физически не успею с этим разобраться(по сути так как у меня SQL Server запущен на локальной машине, то достаточно пробросить соединение в среде Linux, где находится контенер, к моей локальной машине, на которой запущен SQL Server, но на деле оказалось не всё так просто). Так как проект хоть и написан буквально за два дня(суббот и воскресенье), но чтобы его залить и дорефакторить по нормальному у меня ушло буквально по часу в понедельник и вторник.
Ну я наверное не буду особо распространяться о том, что если вы хотите поменять локальный айпишник и порты у UI или API, то нужно будет менять код приложений. Я бы мог описать это пошагово, но тогда файл будет слишком большим.

## Как я понял ТЗ

Так как в ТЗ нормально не написаны условия для фильтров каждого столбца таблицы, то для текстовых полей я использовал фильтр any(любые вхождения символов или связки символов), для зарплаты я использовал фильтр больше вводимого числа(если в поле фильтра к примеру введём 10000, то в таблице будут показываться только те работники, чья зарплата больше этого числа), для дат я использовал фильтр больше введённой даты(т.е. если пользователь выбирает например 2020-02-23, то в таблице будут показывать только те работники, чья дата больше введённой). Немного не понял последний пункт ТЗ, а именно написать "скрипты". Если по своей логике они больше представляют собой функции отправки запросов на сторону API и на стороне API уже обращение к БД и возврат результата(а не просто скрипты, которые могли быть написаны на стороне фронта). Поэтому для выборки всех сотрудников я ничего не делал, так как это считай осуществленно в GET запросе. Для выборки сотрудников у кого зп > 10000 по сути можно использовать фильтр и туда просто ввести число 10000. Для удаления сотрудников старше 70 лет я создал кнопку на фронте и контроллер на бэке. И для обновления зп всё то же самое.

### Заключительная часть. А именно что можно было бы исправить или изменить.

1. Ну понятное дело с вёрсткой сайта можно работать и работать. 
2. Нормально контейнезировать как фронт так и бэк приложения.
3. Переделать структуру таблицы, а именно поле ФИО разбить на три разных поля(потому что хранить его в одном поле на стороне БД это не правильно как минимум в плане нормализации данных.). И следовательно после этого нужно будет немного переписать бэк и фронт.
4. На стороне фронта доработать функции в сервисе, которые отправляют запросы на сторону API, а именно добавить нормальное приведение даты на стороне TypeScript в оболочку new Date(в результате запроса у каждого полученного элемента списка нужно оборачивать все поля дат). Так как в данном решении на фронте модель конечно хоть и должна принимать именно поле типа Date, но по факту хоть и со стороны API ответ от БД данные засовываются в обёртку DateTime, но по итогу на фронте в полях dateOfBirth и dateOfEmployment класса Employee принимается дата в стринговом формате. Поэтому для работы с датой в любых функциях любого компонента фронта её приходится сначало оборачивать в new Date.
